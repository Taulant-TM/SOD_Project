# ğŸ§  Salient Object Detection (SOD) â€” Deep Learning Project

This project implements a **Salient Object Detection (SOD)** system using a
custom TensorFlow/Keras CNN model. The pipeline includes:

âœ” Dataset preparation  
âœ” Preprocessing & augmentation  
âœ” Custom SOD segmentation model  
âœ” Custom loss (BCE + Dice)  
âœ” IoU & F1 metrics  
âœ” Full training loop with checkpoints  
âœ” Evaluation script  
âœ” Gradio real-time demo  
âœ” Clean project structure  

---

## ğŸ“‚ Project Structure

SOD_Project/
â”‚
â”œâ”€â”€ src/
â”‚ â”œâ”€â”€ data_loader.py # Loads images/masks, preprocessing, tf.data pipeline
â”‚ â”œâ”€â”€ prepare_dataset.py # Generates dataset.npz from raw images/masks
â”‚ â”œâ”€â”€ sod_model.py # Model architecture, loss, metrics
â”‚ â”œâ”€â”€ train.py # Training loop with checkpoints & logging
â”‚ â”œâ”€â”€ evaluate.py # Evaluate test set IoU/F1
â”‚ â”œâ”€â”€ demo_gradio.py # Web demo for inference
â”‚
â”œâ”€â”€ scripts/
â”‚ â””â”€â”€ check_data.py # Checks imageâ€“mask mismatches & corrupted files
â”‚
â”œâ”€â”€ data/
â”‚ â”œâ”€â”€ DUTS-TR/ # Raw images 
â”‚ â”œâ”€â”€ DUTS-TE/ # Raw masks 
â”‚ â””â”€â”€ dataset.npz # Prepared dataset generated by prepare_dataset.py
â”‚
â”œâ”€â”€ outputs/
â”‚ â”œâ”€â”€ checkpoints/ # Saved ckpt-*.index files
â”‚ â””â”€â”€ best_model.keras # Best model saved during training
â”‚
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md

---

## ğŸ›  Installation

```bash
git clone https://github.com/yourusername/SOD_Project.git
cd SOD_Project
python -m venv .venv
source .venv/bin/activate   # Windows: .venv\Scripts\activate
pip install -r requirements.txt
ğŸ—‚ Prepare the Dataset
If you have raw images & masks under:


data/DUTS-TR/
data/DUTS-TE/
Run:
python src/prepare_dataset.py
This generates:
data/dataset.npz

The split is:
70% train
15% validation
15% test

ğŸ‹ï¸ Train the Model
python src/train.py

This script:
Loads dataset.npz
Builds a tf.data pipeline
Trains the SOD CNN
Saves checkpoints to outputs/checkpoints/
Saves the best model to outputs/best_model.keras

ğŸ“Š Evaluate on Test Set
python src/evaluate.py

Outputs:
IoU
F1 Score
Loss

ğŸŒ Run the Web Demo (Gradio)
python src/demo_gradio.py

Then open:
http://localhost:7860
Upload an image and see the predicted saliency map.

ğŸ‘¨â€ğŸ’» Author
Taulant Mehana
